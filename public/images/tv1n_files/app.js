var crop_selection,picresize={main:{},edit:{},results:{},batch:{}};picresize.main.init=function(){$(".file_upload").file_upload(),$("body").pastableNonInputable(),$("body").click(),$(window).on("pasteImage",function(e,i){jQuery("#im_clipboard").val(i.dataURL),document.resize_form.submit()})},picresize.main.upload=function(){return $("#picresize-url").hide(),$("#picresize-upload").show(),$("#picresize-url-tab").removeClass("active blue-grey lighten-2"),$("#picresize-upload-tab").addClass("active blue-grey lighten-2"),$("#im_mode").val("local"),!1},picresize.main.url=function(){return $("#picresize-upload").hide(),$("#picresize-url").show(),$("#picresize-upload-tab").removeClass("active blue-grey lighten-2"),$("#picresize-url-tab").addClass("active blue-grey lighten-2"),$("#im_mode").val("url"),!1},picresize.edit.init=function(){crop_selection=$("img#select_pic").imgAreaSelect({instance:!0,handles:!0,onSelectEnd:function(e,i){x=i.x1,y=i.y1,w=i.width,h=i.height,jQuery("#coord_x").val(i.x1),jQuery("#coord_y").val(i.y1),jQuery("#width").val(i.width),jQuery("#height").val(i.height),crop_started=!0,$("#cropbutton").addClass("animated pulse infinite")}}),$("#custom-width").on("keypress",function(e){var i=e.which?e.which:event.keyCode;return!(46!=i&&i>31&&(i<48||i>57))}),$("#custom-width").on("focusout",function(){var e=$(this).val();$(this).val(e.replace(/[^0-9]/g,""))}),$("#custom-height").on("keypress",function(e){var i=e.which?e.which:event.keyCode;return!(46!=i&&i>31&&(i<48||i>57))}),$("#custom-height").on("focusout",function(){var e=$(this).val();$(this).val(e.replace(/[^0-9]/g,""))}),$("#filesize").on("keypress",function(e){var i=e.which?e.which:event.keyCode;return!(46!=i&&i>31&&(i<48||i>57))}),$("#filesize").on("focusout",function(){var e=$(this).val();$(this).val(e.replace(/[^0-9]/g,""))}),Tipped.create("#ef_none","/effects.php",{ajax:{data:{type:"none"}}}),Tipped.create("#ef_badge","/effects.php",{ajax:{data:{type:"badge"}}}),Tipped.create("#ef_blackout","/effects.php",{ajax:{data:{type:"blackout"}}}),Tipped.create("#ef_equalize","/effects.php",{ajax:{data:{type:"equalize"}}}),Tipped.create("#ef_frame","/effects.php",{ajax:{data:{type:"frame"}}}),Tipped.create("#ef_gaussianblur","/effects.php",{ajax:{data:{type:"gaussianblur"}}}),Tipped.create("#ef_grayscale","/effects.php",{ajax:{data:{type:"grayscale"}}}),Tipped.create("#ef_lomo","/effects.php",{ajax:{data:{type:"lomo"}}}),Tipped.create("#ef_oilpaint","/effects.php",{ajax:{data:{type:"oilpaint"}}}),Tipped.create("#ef_polaroid","/effects.php",{ajax:{data:{type:"polaroid"}}}),Tipped.create("#ef_raise","/effects.php",{ajax:{data:{type:"raise"}}}),Tipped.create("#ef_rounded","/effects.php",{ajax:{data:{type:"rounded"}}}),Tipped.create("#ef_scorched","/effects.php",{ajax:{data:{type:"scorched"}}}),Tipped.create("#ef_sharpen","/effects.php",{ajax:{data:{type:"sharpen"}}}),Tipped.create("#ef_slide","/effects.php",{ajax:{data:{type:"slide"}}}),Tipped.create("#ef_spread","/effects.php",{ajax:{data:{type:"spread"}}}),Tipped.create("#ef_tiltshift","/effects.php",{ajax:{data:{type:"tiltshift"}}}),Tipped.create("#ef_warming","/effects.php",{ajax:{data:{type:"warming"}}}),Tipped.create("#max-filesize","Set this if you need your image file<br/>to be under a certain file size.<br/><strong>Tip</strong>: 1024 Kilobytes = 1 Megabyte"),jQuery("#im_color").minicolors(),jQuery("#option_rounded_color").minicolors(),jQuery("#option_polaroid_color").minicolors(),picresize.edit.quality()},picresize.edit.deselect=function(){crop_started&&(crop_selection.cancelSelection(),crop_started=!1),$("#coord_x").val(0),$("#coord_y").val(0),$("#width").val(0),$("#height").val(0),$("#cropbutton").removeClass("animated pulse infinite")},picresize.edit.updateCropDetails=function(){if(orig_width>500)var e=orig_width/500;else e=1;var i=Math.round(jQuery("#width").val()*e),t=Math.round(jQuery("#height").val()*e);jQuery("#new_width_cropped").html(i),jQuery("#new_height_cropped").html(t),picresize.edit.updateResizeDetails()},picresize.edit.updateRotateDetails=function(){var e=cropped_width,i=cropped_height;cropped_width=i,cropped_height=e,jQuery("#new_width_cropped").html(cropped_width),jQuery("#new_height_cropped").html(cropped_height),picresize.edit.updateResizeDetails()},picresize.edit.updateResizeDetails=function(){switch(jQuery("#resizeselect").val()){case"":resized_width=cropped_width,resized_height=cropped_height;break;case"seventyfive":resized_width=Math.round(.75*cropped_width),resized_height=Math.round(.75*cropped_height);break;case"fifty":resized_width=Math.round(.5*cropped_width),resized_height=Math.round(.5*cropped_height);break;case"twentyfive":resized_width=Math.round(.25*cropped_width),resized_height=Math.round(.25*cropped_height);break;case"resolution1600":resize_ratio=1600/cropped_width,resized_width=1600,resized_height=Math.round(cropped_height*resize_ratio);break;case"resolution1280":resize_ratio=1280/cropped_width,resized_width=1280,resized_height=Math.round(cropped_height*resize_ratio);break;case"resolution1024":resize_ratio=1024/cropped_width,resized_width=1024,resized_height=Math.round(cropped_height*resize_ratio);break;case"resolution800":resize_ratio=800/cropped_width,resized_width=800,resized_height=Math.round(cropped_height*resize_ratio);break;case"custom":""!==$("#custom-width").val()&&$("#custom-width").val().match(/^[0-9]+$/)&&""==$("#custom-height").val()?"pr"==$("#im_wmu").val()?(resized_width=Math.round(cropped_width*($("#custom-width").val()/100)),resized_height=Math.round(cropped_height*($("#custom-width").val()/100))):(resized_width=$("#custom-width").val(),resized_height=Math.round(resized_width*cropped_height/cropped_width)):""!==$("#custom-height").val()&&$("#custom-height").val().match(/^[0-9]+$/)&&""==$("#custom-width").val()?"pr"==$("#im_hmu").val()?(resized_height=Math.round(cropped_height*($("#custom-height").val()/100)),resized_width=Math.round(cropped_width*($("#custom-height").val()/100))):(resized_height=$("#custom-height").val(),resized_width=Math.round(resized_height*cropped_width/cropped_height)):$("#custom-width").val().match(/^[0-9]+$/)&&$("#custom-height").val().match(/^[0-9]+$/)?("pr"==$("#im_wmu").val()?resized_width=Math.round(cropped_width*($("#custom-width").val()/100)):resized_width=$("#custom-width").val(),"pr"==$("#im_hmu").val()?resized_height=Math.round(cropped_height*($("#custom-height").val()/100)):resized_height=$("#custom-height").val()):(resized_width=0,resized_height=0)}jQuery("#new_width_final").html(resized_width),jQuery("#new_height_final").html(resized_height)},picresize.edit.resetDetails=function(){cropped_width=orig_width,cropped_height=orig_height,jQuery("#new_width_cropped").html(orig_width),jQuery("#new_height_cropped").html(orig_height),picresize.edit.updateResizeDetails()},picresize.edit.effect=function(){var e=jQuery("input[name=im_effect]:checked","#resize_form").val();switch(jQuery("#formatmessage").html(""),jQuery(".option-effect").fadeOut(),e){case"FilterRounded":jQuery("#options-rounded").fadeIn();break;case"Frame":jQuery("#options-frame").fadeIn();break;case"Raise":jQuery("#options-raise").fadeIn();break;case"FilterPolaroid":jQuery("#options-polaroid").fadeIn();break;case"FilterBadge":jQuery("#options-badge").fadeIn(),jQuery("#format").val("png"),jQuery("#formatmessage").html("Badge Effect requires you to Save As <strong>PNG</strong> format."),picresize.edit.quality()}},picresize.edit.resize=function(){"custom"==document.getElementById("resizeselect").value?$("#customrow").fadeIn():$("#customrow").fadeOut()},picresize.edit.quality=function(){"jpg"==document.getElementById("format").value?($("#jpgquality").show(),$("#jpgfilesize").show()):($("#jpgquality").hide(),$("#jpgfilesize").hide())},picresize.edit.filesize=function(){isNaN($("#filesize").val())&&(alert("Max filesize must be a number (e.g. 100)"),$("#filesize").val(""))},picresize.results.init=function(){picresize.results.countdown()},picresize.results.display=function(e){window.open("/popup.html?"+e,"","resizable=1,HEIGHT=200,WIDTH=200,scrollbars=yes,status=no")},picresize.results.countdownSec=59,picresize.results.countdownMin=19,picresize.results.countdown=function(){picresize.results.countdownSec--,-1==picresize.results.countdownSec&&(picresize.results.countdownSec=59,picresize.results.countdownMin=picresize.results.countdownMin-1),picresize.results.countdownSec<=9&&(picresize.results.countdownSec="0"+picresize.results.countdownSec);var e=(picresize.results.countdownMin<=9?"0"+picresize.results.countdownMin:picresize.results.countdownMin)+":"+picresize.results.countdownSec+" minutes";document.getElementById&&(document.getElementById("theTime").innerHTML=e),SD=window.setTimeout("picresize.results.countdown();",1e3),"00"==picresize.results.countdownMin&&"00"==picresize.results.countdownSec&&window.clearTimeout(SD)},picresize.batch.init=function(){_deferreds.push(script_url+"/batch/jquery.ui.widget.js"),_deferreds.push(script_url+"/batch/jquery.iframe-transport.js"),_deferreds.push(script_url+"/batch/jquery.fileupload.js"),_deferreds.push(script_url+"/batch/jquery.fileupload-process.js"),_deferreds.push(script_url+"/batch/jquery.fileupload-validate.js"),_deferreds.push(script_url+"/batch/main.js")},picresize.batch.resize=function(){"custom"==document.getElementById("resizeselect").value?$("#customrow").fadeIn():$("#customrow").fadeOut()};
